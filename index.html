<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Volerx | زينة رمضان</title>

<style>
:root{
  --black:#111;
  --white:#fff;
  --gold:#c9a24d;
  --blue:#0a1f44;
  --bg:#f2f2f2;
}

*{box-sizing:border-box}

body{
  margin:0;
  font-family:Arial, sans-serif;
  background:var(--bg);
  color:var(--black);
}

/* ===== Banner ===== */
.banner{
  height:180px;
  background:
    linear-gradient(rgba(0,0,0,.6),rgba(0,0,0,.6)),
    url("https://i.postimg.cc/9FR514MS/38CF47CD-3735-4111-8683-B0AC11C51C59.png")
    center/cover no-repeat;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  color:white;
}

.banner h1{
  margin:0;
  font-size:36px;
  letter-spacing:2px;
}

.brand-line{
  width:90px;
  height:3px;
  margin-top:12px;
  background:linear-gradient(to right,var(--gold),var(--blue));
  border-radius:10px;
}

/* ===== Loader ===== */
#loader{
  text-align:center;
  padding:40px;
  font-size:18px;
}

/* ===== Grid ===== */
.grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(170px,1fr));
  gap:16px;
  padding:16px;
}

/* ===== Card ===== */
.card{
  background:var(--white);
  border-radius:14px;
  overflow:hidden;
  box-shadow:0 4px 10px rgba(0,0,0,.12);
  cursor:pointer;
}

/* ===== Categories ===== */
#categories .card{
  background:linear-gradient(to bottom,#fff,#faf7f0);
  border:1px solid rgba(201,162,77,.25);
}

/* ===== Slider ===== */
.slider{
  position:relative;
  height:160px;
  overflow:hidden;
}

.slider img{
  position:absolute;
  inset:0;
  width:100%;
  height:100%;
  object-fit:cover;
  opacity:0;
  animation:fade 9s infinite;
}

.slider img:nth-child(1){animation-delay:0s}
.slider img:nth-child(2){animation-delay:3s}
.slider img:nth-child(3){animation-delay:6s}

@keyframes fade{
  0%{opacity:0}
  10%{opacity:1}
  30%{opacity:1}
  40%{opacity:0}
  100%{opacity:0}
}

/* ===== Product ===== */
.card img{
  width:100%;
  height:180px;
  object-fit:cover;
}

.info{
  padding:12px;
  text-align:center;
}

.info h3{
  margin:0;
  font-size:15px;
}

.price{
  margin-top:6px;
  color:var(--gold);
  font-weight:bold;
}

.btn{
  display:block;
  margin-top:10px;
  padding:8px;
  background:var(--blue);
  color:white;
  text-decoration:none;
  border-radius:8px;
  font-size:14px;
}

/* ===== Utility ===== */
.hidden{display:none}

/* ===== Lightbox ===== */
#lightbox{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.9);
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:999;
}

#lightbox img{
  max-width:90%;
  max-height:90%;
}
</style>
</head>

<body>

<div class="banner">
  <h1>Volerx</h1>
  <div class="brand-line"></div>
</div>

<div id="loader">⏳ جاري تحميل المنتجات...</div>

<div id="categories" class="grid hidden"></div>
<div id="products" class="grid hidden"></div>

<div id="lightbox" class="hidden" onclick="closeImg()">
  <img id="bigImg">
</div>

<script>
const SHEET_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTlN-9WaF9E7jxo836CniVtu6NG1BFJONmi34JAibeRyo1WXtuaW0fpoPz5Ntv8s4eUfmrKIq22CRlS/pub?gid=1564525727&single=true&output=csv";

const loader = document.getElementById("loader");
const categories = document.getElementById("categories");
const products = document.getElementById("products");
const lightbox = document.getElementById("lightbox");
const bigImg = document.getElementById("bigImg");

let data = [];

/* ===== Fetch ===== */
fetch(SHEET_URL)
.then(res => res.text())
.then(text => {
  const lines = text.trim().split("\n");
  const headers = lines[0].split(",");

  for(let i=1;i<lines.length;i++){
    const row = lines[i].split(",");
    let obj = {};
    headers.forEach((h,idx)=>obj[h.trim()] = row[idx]);
    if(obj["اسم المنتج"]) data.push(obj);
  }

  loader.classList.add("hidden");
  showCategories();
})
.catch(()=>{
  loader.innerText = "❌ فشل تحميل البيانات";
});

/* ===== Categories ===== */
function showCategories(){
  categories.innerHTML="";
  categories.classList.remove("hidden");
  products.classList.add("hidden");

  const cats = [...new Set(
    data.map(p => p["القسم"]?.trim()).filter(Boolean)
  )];

  cats.forEach(cat=>{
    const imgs = data
      .filter(p=>p["القسم"]===cat)
      .map(p=>p["رابط الصورة"])
      .slice(0,3);

    categories.innerHTML += `
      <div class="card" onclick="openCategory('${cat}')">
        <div class="slider">
          ${imgs.map(i=>`<img src="${i}">`).join("")}
        </div>
        <div class="info"><h3>${cat}</h3></div>
      </div>
    `;
  });
}

/* ===== Products ===== */
function openCategory(cat){
  products.innerHTML="";
  categories.classList.add("hidden");
  products.classList.remove("hidden");

  data.filter(p=>p["القسم"]===cat).forEach(p=>{
    products.innerHTML += `
      <div class="card">
        <img src="${p["رابط الصورة"]}" onclick="openImg('${p["رابط الصورة"]}')">
        <div class="info">
          <h3>${p["اسم المنتج"]}</h3>
          <div class="price">${p["السعر"]} ₪</div>
          <a class="btn" target="_blank"
             href="https://wa.me/XXXXXXXXXX?text=أرغب بشراء ${p["اسم المنتج"]}">
             طلب عبر واتساب
          </a>
        </div>
      </div>
    `;
  });
}

/* ===== Lightbox ===== */
function openImg(src){
  bigImg.src = src;
  lightbox.classList.remove("hidden");
}
function closeImg(){
  lightbox.classList.add("hidden");
}
bigImg.onclick = e => e.stopPropagation();
</script>

</body>
</html>
